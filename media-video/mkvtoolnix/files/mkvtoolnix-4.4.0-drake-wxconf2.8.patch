--- mkvtoolnix-4.4.0.ebuild	2011-01-23 13:01:19.000000000 +0100
+++ mkvtoolnix-4.4.0-r2.ebuild	2011-01-23 13:01:35.000000000 +0100
@@ -4,7 +4,9 @@
 
 EAPI=3
 
-inherit autotools
+WX_GTK_VER="2.8"
+
+inherit wxwidgets autotools
 
 DESCRIPTION="Tools to create, alter, and inspect Matroska files"
 HOMEPAGE="http://www.bunkus.org/videotools/mkvtoolnix"
@@ -29,9 +31,6 @@
 	lzo? ( dev-libs/lzo )
 	wxwidgets? ( x11-libs/wxGTK:2.8[X] )
 "
-DEPEND="${RDEPEND}
-	dev-ruby/rake
-"
 
 src_prepare() {
 	eautoreconf
@@ -56,12 +55,14 @@
 }
 
 src_compile() {
-	rake || die "rake failed"
+	cd "${S}"
+	./drake "${MAKEOPTS}" || die "drake failed"
 }
 
 src_install() {
 	# Don't run strip while installing stuff, leave to portage the job.
-	DESTDIR="${D}" rake install || die
+	cd "${S}"
+	DESTDIR="${D}" ./drake install || die
 
 	dodoc AUTHORS ChangeLog README TODO || die
 	doman doc/man/*.1 || die
